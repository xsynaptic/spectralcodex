---
import type { GetStaticPaths, InferGetStaticPropsType } from 'astro';

import EphemeraEntry from '#layouts/ephemera-entry.astro';
import { getEphemeraCollection } from '#lib/collections/ephemera/ephemera-data.ts';
import { getContentBacklinksFunction } from '#lib/metadata/metadata-backlinks.ts';

export const getStaticPaths = (async () => {
	const { ephemera } = await getEphemeraCollection();

	const getContentBacklinks = await getContentBacklinksFunction();

	return ephemera.map((entry) => ({
		params: { ephemera: entry.id },
		props: {
			entry,
			backlinks: getContentBacklinks({ id: entry.id }),
		},
	}));
}) satisfies GetStaticPaths;

type Props = InferGetStaticPropsType<typeof getStaticPaths>;
---

<EphemeraEntry {...Astro.props} />
