---
import type { GetStaticPaths, InferGetStaticPropsType } from 'astro';

import { FEATURE_DATE_ARCHIVES } from '#constants.ts';
import TimelineYearly from '#layouts/timeline-yearly.astro';
import { getTimelineData } from '#lib/timeline/timeline-data.ts';

export const getStaticPaths = (async () => {
	if (!FEATURE_DATE_ARCHIVES) return [];

	const { timelineYearly, timelineYears } = await getTimelineData();

	if (!timelineYearly) return [];

	return Object.entries(timelineYearly).map(([timelineYear, timelineMonthlyData]) => ({
		params: { year: timelineYear },
		props: {
			timelineMonthlyData,
			timelineYear,
			timelineYears,
		},
	}));
}) satisfies GetStaticPaths;

type Props = InferGetStaticPropsType<typeof getStaticPaths>;
---

<TimelineYearly {...Astro.props} />
